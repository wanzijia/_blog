<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS模块化 | ZIJIA</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo/logo.jpg">
    <meta name="description" content="子佳的博客">
    
    <link rel="preload" href="/assets/css/0.styles.d3e1b34d.css" as="style"><link rel="preload" href="/assets/js/app.bb29d11c.js" as="script"><link rel="preload" href="/assets/js/2.571a1620.js" as="script"><link rel="preload" href="/assets/js/19.5129347e.js" as="script"><link rel="prefetch" href="/assets/js/10.0a312df9.js"><link rel="prefetch" href="/assets/js/11.760b0bd6.js"><link rel="prefetch" href="/assets/js/12.dd0497aa.js"><link rel="prefetch" href="/assets/js/13.088063bb.js"><link rel="prefetch" href="/assets/js/14.13d23d82.js"><link rel="prefetch" href="/assets/js/15.71664f81.js"><link rel="prefetch" href="/assets/js/16.1afa945d.js"><link rel="prefetch" href="/assets/js/17.f7721fec.js"><link rel="prefetch" href="/assets/js/18.3ecfe8fa.js"><link rel="prefetch" href="/assets/js/20.cdb26a80.js"><link rel="prefetch" href="/assets/js/21.860c81a0.js"><link rel="prefetch" href="/assets/js/22.b4dda94d.js"><link rel="prefetch" href="/assets/js/23.f2e5cd85.js"><link rel="prefetch" href="/assets/js/24.cbcbaa41.js"><link rel="prefetch" href="/assets/js/25.cf629994.js"><link rel="prefetch" href="/assets/js/26.c4c3a5cf.js"><link rel="prefetch" href="/assets/js/27.e32ee73a.js"><link rel="prefetch" href="/assets/js/28.34c15a66.js"><link rel="prefetch" href="/assets/js/3.065fc958.js"><link rel="prefetch" href="/assets/js/4.1338cb60.js"><link rel="prefetch" href="/assets/js/5.c0948713.js"><link rel="prefetch" href="/assets/js/6.31c0c849.js"><link rel="prefetch" href="/assets/js/7.4741cb27.js"><link rel="prefetch" href="/assets/js/8.b55d0628.js"><link rel="prefetch" href="/assets/js/9.121a3a86.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d3e1b34d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ZIJIA</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/promise/" class="nav-link">
  Promise以及事件循环机制
</a></li><li class="dropdown-item"><!----> <a href="/js/program/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/js/program/oop.html" class="nav-link">
  面向对象
</a></li><li class="dropdown-item"><!----> <a href="/js/browser/" class="nav-link">
  浏览器相关
</a></li><li class="dropdown-item"><!----> <a href="/js/apiDoc/" class="nav-link">
  api使用
</a></li></ul></div></div><div class="nav-item"><a href="/module/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  模块化
</a></div><div class="nav-item"><a href="/ts/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/engineered/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue相关" class="dropdown-title"><span class="title">Vue相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue相关" class="mobile-dropdown-title"><span class="title">Vue相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue2/" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/vue/vueRouter/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/vue/principle/" class="nav-link">
  Vue源码解析
</a></li></ul></div></div><div class="nav-item"><a href="/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/performanceOptimization/" class="nav-link">
  性能优化
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题整理
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/promise/" class="nav-link">
  Promise以及事件循环机制
</a></li><li class="dropdown-item"><!----> <a href="/js/program/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/js/program/oop.html" class="nav-link">
  面向对象
</a></li><li class="dropdown-item"><!----> <a href="/js/browser/" class="nav-link">
  浏览器相关
</a></li><li class="dropdown-item"><!----> <a href="/js/apiDoc/" class="nav-link">
  api使用
</a></li></ul></div></div><div class="nav-item"><a href="/module/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  模块化
</a></div><div class="nav-item"><a href="/ts/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/engineered/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue相关" class="dropdown-title"><span class="title">Vue相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue相关" class="mobile-dropdown-title"><span class="title">Vue相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue2/" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/vue/vueRouter/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/vue/principle/" class="nav-link">
  Vue源码解析
</a></li></ul></div></div><div class="nav-item"><a href="/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/performanceOptimization/" class="nav-link">
  性能优化
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题整理
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/module/" aria-current="page" class="active sidebar-link">JS模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/module/#一、幼年期-无模块化" class="sidebar-link">一、幼年期： 无模块化</a></li><li class="sidebar-sub-header"><a href="/module/#二、成长期-模块化的雏形-iife-语法侧的优化" class="sidebar-link">二、成长期： 模块化的雏形 - IIFE（语法侧的优化）</a></li><li class="sidebar-sub-header"><a href="/module/#三、成熟期" class="sidebar-link">三、成熟期：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/module/#cjs-commonjs" class="sidebar-link">CJS - Commonjs</a></li><li class="sidebar-sub-header"><a href="/module/#amd规范" class="sidebar-link">AMD规范</a></li><li class="sidebar-sub-header"><a href="/module/#cmd规范" class="sidebar-link">CMD规范</a></li><li class="sidebar-sub-header"><a href="/module/#es6模块化" class="sidebar-link">ES6模块化</a></li></ul></li><li class="sidebar-sub-header"><a href="/module/#模块化有关的面试题" class="sidebar-link">模块化有关的面试题</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js模块化"><a href="#js模块化" class="header-anchor">#</a> JS模块化</h1> <h4 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h4> <p>JS本身简单的页面设计：页面动画 + 表单提交
并无模块化 or 命名空间的概念</p> <blockquote><p>JS的模块化需求日益增长</p></blockquote> <h2 id="一、幼年期-无模块化"><a href="#一、幼年期-无模块化" class="header-anchor">#</a> 一、幼年期： 无模块化</h2> <ol><li>开始需要在页面中增加一些不同的js：动画、表单、格式化</li> <li>多种js文件被分在不同的文件中</li> <li>不同的文件又被同一个模板引用</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;jquery.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;main.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;dep1.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
  <span class="token comment">//……</span>
</code></pre></div><p>认可：
文件分离是最基础的模块化第一步
问题出现：</p> <ul><li>污染全局作用域 =&gt; 不利于大型项目的开发以及多人团队的共建</li></ul> <h2 id="二、成长期-模块化的雏形-iife-语法侧的优化"><a href="#二、成长期-模块化的雏形-iife-语法侧的优化" class="header-anchor">#</a> 二、成长期： 模块化的雏形 - IIFE（语法侧的优化）</h2> <h4 id="作用域的把控"><a href="#作用域的把控" class="header-anchor">#</a> 作用域的把控</h4> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// ex:</span>
  <span class="token comment">// 定义一个全局变量</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// 代码块1</span>
  <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
  <span class="token comment">// 代码块2</span>
  <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>利用函数块级作用域</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// ……</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>仅定义了一个函数，如果立即执行</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// ……</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>初步实现了一个最最最最简单的模块</p> <p>尝试去定义一个最简单的模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> iifeModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">increase</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>有额外依赖时，如何优化IIFE相关代码</strong></p> <blockquote><p>优化1： 依赖其他模块的IIFE</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> iifeModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dependencyModule1<span class="token punctuation">,</span> dependencyModule2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">increase</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dependencyModule1<span class="token punctuation">,</span> dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>
iifeModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iifeModule<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>实际上，jquery等框架其实应用了revealing的写法：（api定义在函数中，仅仅暴露接口这个思想）
揭示模式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> iifeModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dependencyModule1<span class="token punctuation">,</span> dependencyModule2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    increase<span class="token punctuation">,</span> reset
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dependencyModule1<span class="token punctuation">,</span> dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>
iifeModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iifeModule<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="三、成熟期"><a href="#三、成熟期" class="header-anchor">#</a> 三、成熟期：</h2> <h3 id="cjs-commonjs"><a href="#cjs-commonjs" class="header-anchor">#</a> CJS - Commonjs</h3> <p>node.js制定
特征：</p> <ul><li>通过module + exports 去对外暴露接口</li> <li>通过require来调用其他模块</li></ul> <p>模块组织方式
main.js 文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入部分</span>
<span class="token keyword">const</span> dependencyModule1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dependencyModule2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 处理部分</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 做一些跟引入依赖相关事宜……</span>

<span class="token comment">// 暴露接口部分</span>
exports<span class="token punctuation">.</span>increase <span class="token operator">=</span> increase<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>reset <span class="token operator">=</span> reset<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  increase<span class="token punctuation">,</span> reset
<span class="token punctuation">}</span>
</code></pre></div><p>模块使用方式</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> <span class="token punctuation">{</span> increase<span class="token punctuation">,</span> reset <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./main.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>优点：
CommonJS率先在服务端实现了，从框架层面解决依赖、全局变量污染的问题</li> <li>缺点：
主要针对了服务端的解决方案。对于异步拉取依赖的处理整合不是那么的友好。
为什么不去考虑异步
因为服务端文件都在硬盘上，所以同步加载读取很快 fs的读取非常快</li></ul> <h3 id="amd规范"><a href="#amd规范" class="header-anchor">#</a> AMD规范</h3> <p>通过异步加载 + 允许制定回调函数<br>
经典实现框架是：require.js</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 通过define来定义一个模块，然后require进行加载</span>
  <span class="token comment">/*
  define
  params: 模块名，依赖模块，工厂方法
   */</span>
  <span class="token function">define</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">[</span>depends<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span>module<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>模块定义方式</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dependencyModule1'</span><span class="token punctuation">,</span> <span class="token string">'dependencyModule2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">dependencyModule1<span class="token punctuation">,</span> dependencyModule2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token comment">// 处理部分</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      increase<span class="token punctuation">,</span> reset
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>引入模块：</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'amdModule'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token parameter">amdModule</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    amdModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>如果在AMDmodule中想兼容已有代码，怎么办</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token parameter">require</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 引入部分</span>
    <span class="token keyword">const</span> dependencyModule1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dependencyModule2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 处理部分</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 做一些跟引入依赖相关事宜……</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      increase<span class="token punctuation">,</span> reset
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="cmd规范"><a href="#cmd规范" class="header-anchor">#</a> CMD规范</h3> <p>按需加载
主要应用的框架 sea.js</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// jquery相关逻辑</span>

    <span class="token keyword">let</span> dependencyModule1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dependecyModule1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// dependencyModule1相关逻辑</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>优点：按需加载，依赖就近</li> <li>依赖于打包，加载逻辑存在于每个模块中，扩大模块体积</li></ul> <h3 id="es6模块化"><a href="#es6模块化" class="header-anchor">#</a> ES6模块化</h3> <p>新增定义：
引入关键字 —— import
导出关键字 —— export
模块引入、导出和定义的地方：</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 引入区域</span>
  <span class="token keyword">import</span> dependencyModule1 <span class="token keyword">from</span> <span class="token string">'./dependencyModule1.js'</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> dependencyModule2 <span class="token keyword">from</span> <span class="token string">'./dependencyModule2.js'</span><span class="token punctuation">;</span>

  <span class="token comment">// 实现代码逻辑</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 导出区域</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    increase<span class="token punctuation">,</span> reset
  <span class="token punctuation">}</span>
</code></pre></div><p>模板引入的地方</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;esModule.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>node中：</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span> increase<span class="token punctuation">,</span> reset <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./esModule.mjs'</span><span class="token punctuation">;</span>
  <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">import</span> esModule <span class="token keyword">from</span> <span class="token string">'./esModule.mjs'</span><span class="token punctuation">;</span>
  esModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  esModule<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>优点（重要性）：通过一种最统一的形态整合了js的模块化</li> <li>缺点（局限性）：本质上还是运行时的依赖分析</li></ul> <h2 id="模块化有关的面试题"><a href="#模块化有关的面试题" class="header-anchor">#</a> 模块化有关的面试题</h2> <ol><li><p>AMD&amp;CMD区别<br>
依赖就近，按需加载</p></li> <li><p>了解早期jquery的依赖处理以及模块加载方案吗？/ 了解传统IIFE是如何解决多方依赖的问题？<br>
IIFE加传参调配，jquery等框架其实应用了revealing（揭示模式）的写法：（api定义在函数中，仅仅暴露接口这个思想）</p></li> <li><p>AMD中使用revealing</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> <span class="token keyword">export</span><span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 引入部分</span>
    <span class="token keyword">const</span> dependencyModule1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dependencyModule2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 处理部分</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 做一些跟引入依赖相关事宜……</span>

    <span class="token keyword">export</span><span class="token punctuation">.</span>increase <span class="token operator">=</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span><span class="token punctuation">.</span>reset <span class="token operator">=</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token parameter">require</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> otherModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherModule<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>兼容AMD&amp;CJS/如何判断CJS和AMD**</li></ol> <p>UMD的出现</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token punctuation">(</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'amdModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 引入部分</span>
    <span class="token keyword">const</span> dependencyModule1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dependencyModule2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span>dependencyModule2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 处理部分</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 做一些跟引入依赖相关事宜……</span>

    exports<span class="token punctuation">.</span>increase <span class="token operator">=</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exports<span class="token punctuation">.</span>reset <span class="token operator">=</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
    <span class="token comment">// 目标是一次性区分CommonJSorAMD</span>
    <span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span>
    <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>exports
    <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> define <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span>
      <span class="token operator">?</span> <span class="token comment">// 是 CJS</span>
        <span class="token parameter">factory</span> <span class="token operator">=&gt;</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module<span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token comment">// 是AMD</span>
        define
  <span class="token punctuation">)</span>
</code></pre></div><ul><li>优点: 适合在浏览器中加载异步模块，可以并行加载多个模块</li> <li>缺点：会有引入成本，不能按需加载</li></ul> <ol start="5"><li>import如何解决动态模块</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myImport</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ES11原生解决方案：</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./esModule.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">dynamicEsModule</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    dynamicEsModule<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.bb29d11c.js" defer></script><script src="/assets/js/2.571a1620.js" defer></script><script src="/assets/js/19.5129347e.js" defer></script>
  </body>
</html>
